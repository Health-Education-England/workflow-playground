name: Build and Deploy

on:
  push:
    branches:
      - main

jobs :
  build:
    uses: ./.github/workflows/build.yml

  deploy-preprod:
    needs: build
    uses: ./.github/workflows/deploy.yml
    with:
      environment: preprod

  deploy-prod:
    needs: deploy-preprod
    uses: ./.github/workflows/deploy.yml
    with:
      environment: prod

  deploy-nimdta:
    needs: deploy-preprod
    uses: ./.github/workflows/deploy.yml
    with:
      environment: nimdta
